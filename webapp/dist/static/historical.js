!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=2)}([function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));const o=new Promise((function(e){"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?e():document.addEventListener("DOMContentLoaded",e)})),r=e=>new Date(new Date(e).getTime()+60*(new Date).getTimezoneOffset()*1e3).toLocaleDateString(),a=e=>new Date(new Date(e).getTime()+60*(new Date).getTimezoneOffset()*1e3)},,function(e,t,n){"use strict";n.r(t);var o=n(0);window.onbeforeunload=function(){window.scrollTo(0,0)},ko.bindingHandlers.highstock={update:function(e,t,n){var o=ko.unwrap(t()),r=null!=o&&null!=o.options?o.options:o;Highcharts.stockChart(e,r)}};const r=e=>new Promise((t,n)=>{const r=e.map(({criteria:e={}})=>{const{state:t=!1,county:n=!1}=e;let o="";return t&&(o=`?state=${t}`+(n?`&county=${n}`:"")),r=`/historical/data.json${o}`,new Promise(e=>{Highcharts.getJSON(r,t=>{e(t)})});var r});return Promise.all(r).then(r=>{const a=r.map((t,r)=>{const a=e[r].key,{error:i=!1,rows:s=[]}=t;return i?n(i):{name:a,data:s.map(e=>[Object(o.a)(e.date).getTime(),parseInt(e.cases)]),tooltip:{valueDecimals:0}}});return t({options:{rangeSelector:{selected:1},title:{text:null},series:a}})})}),a=({state:e=!1}={})=>new Promise((t,n)=>{const o=e?`?state=${e}`:"";Highcharts.getJSON(`/historical/drill-down-options.json${o}`,({rows:e=null,error:o=!1})=>{if(o)return n(o);t(e)})});class i{constructor(e,t){var n=this;this.selectedTickers=ko.observableArray([{key:this.constructor.US_TICKER_KEY}]),this.options=ko.observable(e),this.state=ko.observable(!1),this.county=ko.observable(!1),this.stateOptions=ko.observableArray(t),this.countyOptions=ko.observableArray([]),this.hasCountyOptions=ko.computed(()=>this.countyOptions().length>0),window.model=this,this.onAdd=function(e,t){n.populateData()},this.onRemoveTicker=function(e,t){const o=t.currentTarget.getAttribute("data-key"),r=n.selectedTickers().findIndex(e=>e.key==o);n.selectedTickers.splice(r,1),n.refreshChart(n.selectedTickers())},this.onDrillDown=function(e,t){t.preventDefault(),t.stopPropagation();const o=e.state();if(!o)return alert("Please select a state/territory"),!1;a({state:o}).then(e=>{n.countyOptions(e)}).catch(()=>alert("Fail to load  drill down options, please try again"))},this.onFormClear=function(e,t){t.preventDefault(),t.stopPropagation(),n.state(void 0),n.county(!1),n.countyOptions([]),n.selectedTickers([]),n.populateData()},this.onStateChange=function(e,t){n.county(null),n.countyOptions([])},this.populateData=function(){const e=n.state(),t=n.county(),o=n.selectedTickers();let r={};if(r=e&&!t?{key:e,criteria:{state:e}}:e&&t?{key:`${t}, ${e}`,criteria:{state:e,county:t}}:{key:n.constructor.US_TICKER_KEY},o.some(e=>e.key==r.key))return alert(`${r.key} is already in the chart`),!1;o.push(r),n.refreshChart(o)},this.refreshChart=e=>{r(e).then(({options:t})=>{n.options(t),n.selectedTickers(e)}).catch(e=>{alert("Fail to load data for rendering the chart. Please try again!"),console&&console.log(e)})}}}i.US_TICKER_KEY="US Nationwide",o.c.then((function(){Promise.all([r([{key:i.US_TICKER_KEY}]),a()]).then(([{options:e},t])=>{var n=new i(e,t);ko.applyBindings(n,document.getElementById("app"))}).catch(e=>{alert("Sorry, error encountered, please try again!"),console&&console.log(e)})}))}]);